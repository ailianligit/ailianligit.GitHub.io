# 线性规划

## 图解法

- 线性规划的最优解总可以在角点处找到



## 线性规划模型

- 极大值（极小值）模型
- 约束条件应满足：
  - 除非负性约束外，所有约束都是等式，并且右端项非负
  - 所有变量非负
  - 系数矩阵行满秩



## 单纯形法

- 从可行解的一个角点移动到相邻的更好的角点，直至发现最优角点
  - 保证下一次移动更好：
  - 保证移动过程始终可行：
- 基解：解空间中所有的角点，$x$中的非零变量
  - 可行解空间中的角点称为可行基解
- 进基变量：单纯性表中$z$行的绝对值最大的负（正）系数
  - 保证了选定的方向是函数值增大最快的方向
- 离基变量：具有正分母的且具有最小非负比的基变量
  - 最小非负比保证解是基可行解
  - 比值为0代表该变量相当于在上一步离基，此时离基不会对解有任何改善
- 最优性条件：$z$行中所有非基变量的系数非负（正）
  - 基变量$z$行系数为0
- 无界解条件：主列不存在具有正分母的基变量
- 若初始$z$行基变量的系数不为0，需要进行修正



## 人工初始解

### 大M法

### 两阶段法

- 阶段1中令所有人工变量之和为目标函数，得到最优基可行解
- 如果最优目标函数值为正数，则原问题没有可行解
- 阶段1的最优基可行解作为原问题的初始基可行解



## 单纯形法中解的特殊情况

### 退化解

- 当最小非负比出现在多处时，迭代后至少有一个基变量取零值
- 将比值为0的基变量离基后，结果不会改善



### 无穷多最优解

- 当目标函数平行于非冗余的起作用约束时，产生无穷多最优解
- $z$行中存在非基变量系数为0时，有无穷多最优解



### 无界解

- 可以无限制增加变量值而不破坏任何约束



### 无可行解

- 在大M法或两阶段法中的阶段1的最优单纯性表中，存在人工变量取正值，则原问题无可行解



## 单纯形法的原理

- 若存在可行解，则存在基可行解
- 若存在最优可行解，则存在最优基可行解
- 若某可行解满足最优性条件，则该解是最优的



## 对偶

- 原始问题的目标极大（小）化
  - 对偶问题的目标极小（大）化
  - **约束类型≥（≤）**
  - 若变量符号无限制，则令$y=y^+-y^-$
- 无符号变量对应的对偶约束是等式形式
- 若原问题有最优解，则原对偶问题的最优目标函数值相等
- 若原问题有无界解，则对偶问题无可行解
  - 若原问题不可行，则对偶问题不一定有无界解，可能不可行
- 原问题为极大化问题时，弱对偶定理：$w\ge z$



## 三种单纯形法

### 原始单纯形法

- 从一组基可行解开始，每次迭代保持可行性，直至满足最优性



### 对偶单纯形法

- 从一组满足最优性条件但不满足可行性条件的基解开始，每次迭代保持最优性，最终满足可行性条件
- 若初始解满足最优性条件但不可行，则最优单纯形表中解满足最优性条件且可行
- 若初始解既非可行、又非最优，则最优单纯形表中解可行但不是最优解（广义单纯形法）
- 所有约束类型都是≤
- 目标函数的系数满足单纯形法的最优性条件
  - 极大值问题，$z$行系数非负
  - 极小值问题，$z$行系数非正
  - 可以对不满足条件的系数引入人工约束，使用原始单纯形法迭代后即满足条件
- 对偶离基准则：基变量中绝对值最大的负数
  - 可行性检验：若所有基变量非负，则可行性条件恢复
  - 原始单纯形法：具有正分母的且具有最小非负比（max）的基变量
- 对偶进基准则：具有负分母的且具有最小绝对值比的基变量
  - 无可行性检验：若所有非基变量分母非负，则原问题无可行解
  - 原始单纯形法：单纯性表中$z$行的绝对值最大的负（max）系数



### 广义单纯形法

- 初始基解可以既非可行、又非最优
- 先利用对偶单纯形法恢复解的可行性，再利用原始单纯形法恢复解的可行性



## 线性规划的内点法

- 多项式时间；沿着目标函数梯度方向确定下一个迭代点；通过变换，当前迭代点始终位于可行解空间的中心附近
- 给定当前迭代点$x$，令$D=\text{diag}(x)$；计算$\tilde{A}=AD$，$\tilde{c}=Dc$
  - 离边界远，可以选择较大的$\alpha$，投影梯度的方向更加接近最优解的位置

- 计算投影矩阵：$P=I-\tilde{A}^{T}(\tilde{A}\tilde{A}^T)^{-1}\tilde{A}$；计算投影梯度：$c_P=P\tilde{c}$
  - $c$是目标函数的梯度
- 令$v$为$c_P$中最负分量的绝对值，$\tilde{x}=1_{n}+\frac{\alpha}{v} c_P$；计算新的迭代点$x=D\tilde{x}$
  - $\alpha$趋近于1，尽量增加$z$值
  - $\alpha$趋近于0，迭代点接近可行解空间