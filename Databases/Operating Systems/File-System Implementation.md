### 分层设计的文件系统及作用

- 逻辑文件系统：管理目录；通过FCB管理文件；提供保护和安全
- 文件组织模块：将逻辑地址转化为物理地址；空闲空间管理
- 基本文件系统：向对应的设备驱动程序发送命令
- I/O控制层：**设备驱动程序**和**中断处理程序**负责在内存和磁盘之间传输信息



### 虚拟文件系统的定义与特点

- 虚拟文件系统提供了一种实现文件系统的面向对象的方式
- 虚拟文件系统在不同类型的文件系统上应用了相同的系统调用接口（API），API针对虚拟文件系统接口



### 目录实现的分类及优缺点（角度：开销）

- 线性表

  优点：易于实现

  缺点：耗时

- 哈希表

  优点：搜索时间短

  缺点：哈希冲突、大小固定



### 分配方式及优缺点（角度：随机访问、内存空间、延展性、访问速度）

- 连续分配

  优点：简单、随机访问、速度快

  缺点：外部碎片（连续存储分配问题）、文件延展性差

- 链式分配

  优点：文件延展性好、节约内存空间

  缺点：指针占用一定空间、指针实现的开销、无法随机访问（需要多次访问磁盘）、断链时造成内存浪费、访问速度慢

- 索引分配

  优点：随机访问、延展性好、节约内存空间

  缺点：访问两次内存、索引表开销



### 分配方式及读取块的数量

- 连续分配：1块
- 链式分配：从头指针指向的块开始逐一读取
- 索引分配：2块（一级索引）



### 每种分配方式的改进方法及优缺点

- 连续分配

  外部碎片：压缩（时间开销）

  文件延展性差：扩展（可能存在的外部碎片和内部碎片）

- 链式分配

  指针占用一定空间：簇（指针空间占比小、吞吐量大；随机访问时间长，外部碎片）

  无法随机访问：文件分配表（随机访问；FAT放在卷头，每次访问磁头需要移动2次）

- 索引分配

  簇、FAT、将索引表放在cache中



### 扩展的分配方案与分析（角度：分配开销、内部碎片、外部碎片）

- 预先定义的相同大小的扩展：位图或空闲块列表即可实现

  不会产生外部碎片，分配开销少

  若扩展太大会产生内部碎片，若太小会影响访问效率

- 动态分配的任意大小的扩展：实现困难

  内部碎片少

  外部碎片多，且分配过程产生较大开销

- 预先定义的多种大小的扩展：不同大小的位图或空闲块列表

  内部碎片和外部碎片都少

  位图或空闲块列表带来一定的开销



### UNIX文件管理方式的优点

- 索引节点大小固定，且相对较小
- 小文件：直接块，快速访问，减少处理时间
- 大文件：多级间接块也能满足需求



### 空闲空间管理方式及优缺点（角度：连续、浪费）

- 位图
- 链表



### 空闲空间管理方式的改进方法

- 分组（成组链接法）：可以迅速找到大量的空闲盘块
- 计数：空闲空间列表的每个条目由一个磁盘地址和一个计数组成



### 修复损坏的文件系统结构的方法

- 一致性检查器：读取文件系统元数据并尝试纠正数据不一致的情况



### 提升文件系统性能的方法

- 日志文件：包含错误或其他信息，用于调试或了解系统状态的文件
- 缓存



### 提升文件系统可靠性的方法

- 日志文件
- 独立磁盘冗余阵列