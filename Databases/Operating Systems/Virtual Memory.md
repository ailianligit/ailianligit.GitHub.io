### 虚拟内存的优势

- 增加多道程序的程度
- 进程可以比物理内存还要大
- 通过共享内存可以共享文件和库
- 高效的进程创建方法：写时复制和内存映射文件



### 按需调页的流程

- 请求访问某个页
- 若为无效引用，则生成地址错误异常
- 若不在内存中，则将该页带入内存中



### 按需调页的优势

- 增加多道程序的程度，更多的用户
- 更少的I/O
- 更短的响应时间
- 更少的内存空间



### 交换与调页的区别和优劣

- 交换是将整个进程（逻辑地址空间）换入或换出，系统可以容纳比实际物理内存**更多的进程**，缺点是在内存和后备存储之间移动整个进程非常费时
- 调页是将逻辑地址分页后，按需换入或换出内存，不必将整个进程整体进行交换，提高了**多道程序的程度**，减少了**I/O次数**和**响应时间**，需要的**内存容量**减少



### 有效位的功能

- 识别页是否在内存中




### 页面错的含义和处理步骤

- 由于对非内存驻留页的引用而导致的异常
- 处理步骤：
  - 寻找空闲帧，若没有找到，则需要利用页面置换算法在内存中选择一个帧换出，将页表中该页对应的有效位置为无效
  - 若找到空闲帧，则操作系统将指定页面放入该帧中，并重置页表和帧表，更新帧号和有效位，最后重启造成了页面错的指令



### 写时复制的原理和意义

- 原理：共享页面或创建进程时，复用本身已经存在的页面，若需要对页面进行写操作时，则复制该页面
- 意义：快速创建子进程



### 脏位的含义和意义

- 含义：指示该页是否被修改过
- 意义：只有修改过的页面才需要被写入磁盘中，煎炒页传输的开销



### 虚拟内存分配的流程

- 在磁盘中找到需要调度的**页**的位置
- 寻找空闲帧，若没有找到，则需要利用页面置换算法在内存中选择一个帧换出，将页表中该页对应的有效位置为无效
- 若找到空闲帧，则操作系统将指定页面放入该帧中，并更新页表和**帧表**，更新帧号和有效位，最后重启造成了页面错的指令



### 页面置换算法的衡量因素（目标）

- 最小页面错



### 内存帧数和缺页率的关系（Belady异常）

- 内存帧数越多，缺页率越低
- Belady异常：在FIFO算法中，可能发生的内存帧数越多，缺页率反而上升的异常现象



### 页面置换算法及其理由和优劣

- FIFO：先进先出算法
  - 理由：最早调入主存的页面不再访问的可能性大
  - 优势：实现简单、线性访问
  - 劣势：Belady异常、效率不高
- LRU：最近最少使用算法
  - 理由：局部性原理
  - 优势：接近实际
- OPT：最优算法
  - 理由：考虑了调度序列
  - 优势：最优、理论意义
  - 劣势：难以实现
- LFU：最小频率算法
  - 理由：使用频率小
  - 劣势：如果之前某页面使用次数太多，会影响后续判断（指数衰减）
- MFU：最大频率算法
  - 理由：使用频率小的页面可能刚刚调入主存还未被使用



### 帧分配策略（页面置换算法）的分类及优劣（角度：整体错误率、内存利用率和使用平衡）

- 全局分配

  优势：内存利用率高，使用较为平衡

  劣势：提高了整体的页面错误率

- 局部分配

  优势：控制了整体的页面错误率

  劣势：内存利用率低，使用不平衡



### 颠簸产生的原因

- 某个进程需要分配更多的内存帧，页面错误率提高
- 采用全局页面置换算法，从其他进程中拿走帧
- 被拿走帧的进程也需要这些帧，页面错误率再次提高
- 发生页面错的进程需要使用调页设备来换入和换出
- 这些进程都在调页设备中排队，准备队列就空了，CPU利用率下降
- 调度器检测到CPU利用率的下降，就增加多道程序的度数
- 新的进程从正在运行的进程中获取帧，**页面错误率**增加，**调页设备队列**变长，**CPU利用率**进一步下降
- 系统**吞吐率**暴跌



### 多道程序的程度与CPU利用率的关系

- 多道程序的程度越大，CPU利用率越大
- 当发生颠簸时，多道程序的程度越大，CPU利用率下降



### 颠簸的解决方法

- 局部页面置换算法
- 缺页频率：设置缺页率上限和下限；若没有空闲帧可供使用，需要将优先级较低的进程整个换出到后备存储



### 工作集和驻留集之间的关系

- 驻留集监控工作集的情况，并以此调整工作集



### 页大小与缺页率的关系

- 页越小，则内存中可以容纳的帧数越多，页面错误率下降
- 页越大，则工作集集中在少数的页中，页面错误率下降



### 分页设备队列过长（过度分配）时提升CPU利用率的方案

- 角度：降低页面错误率，CPU更快地从磁盘获取更多的数据
- 减小多道程序的度数：减少页面错误率，增加CPU利用率
- 安装更多的内存：容纳更多的帧且减少页面错误率，增加CPU利用率
- 安装一个更大的硬盘或多硬盘上的多控制器：基于更快的响应和更大的磁盘吞吐量，CPU将更快地获取更多的数据
- 给页面获取算法添加预取策略：只有当调页支持预取时，CPU才能通过预取获得更多的数据，从而提升CPU利用率
- 增加页的大小：在线性访问的情况下，能够降低页面错误率；在随机访问的情况下，因为内存中容纳帧的数量减少，每次调页的时间开销大
