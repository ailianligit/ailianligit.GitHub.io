# Multi-Aspect Dense Retrieval

## 研究背景

- 信息检索领域普遍采用召回+排序的两阶段架构，召回是在海量文档中选出可能与查询相关的文档，这些候选文档按相关性进行排序，得到检索的结果。本文聚焦于密集检索中召回阶段的设计。

- 常规双向编码密集检索模型

  - 原理：使用双向编码的设计对查询和文档进行**独立**编码，然后使用一些相似性函数（如：余弦函数）计算**相关性分数**。加上**快速近似最近邻搜索（ANNS）**的方法，模型能够预先计算文档的嵌入，进行离线索引，提高检索的效率。

  - 缺陷：在相关性匹配中，单向量表示的方法不能有效捕捉查询和文档的**不同方面**的信息，尤其是在一些垂直的领域。



## 主要贡献

- **多方面密集检索模型（MADRM）**
  - 这是一种**密集检索**模型，使用**多重嵌入**的方式显式表示一个查询或一个文档的不同方面的信息。
  - **方面嵌入**：基于**注意力**的**方面提取网络（AEN）**为不同的方面提取嵌入。
  - **方面学习**：用于训练方面嵌入的**方面预测任务**，不仅能够教给模型领域的知识，通过多任务学习提高检索的质量，还能指导模型用特定方面嵌入来表示每个方面的信息。
  - **轻量级方面融合网络（AFN）**：融合多方面嵌入，用来表示查询和文档，这有助于节约索引空间，并降低索引和查询的复杂度。
  - 与密集检索和多任务学习的基线对比，MADRM有更好的性能和可解释性。

<img src="C:\Users\Elian Li\AppData\Roaming\Typora\typora-user-images\image-20221116094046964.png" alt="image-20221116094046964" style="zoom: 50%;" />



## 模型架构

### 方面提取网络（AEN）

- 给定查询和文档，分别表示为tokens序列，输入到BERT中，得到初始表示。
- 以初始表示为输入，借助**注意力**机制将文本输入的不同部分抽取为方面嵌入。

<img src="C:\Users\Elian Li\AppData\Roaming\Typora\typora-user-images\image-20221116105315659.png" alt="image-20221116105315659" style="zoom: 50%;" />

### 方面学习

- **方面预测任务**：显式表示查询和文档不同方面的信息
- 每个方面都对应一个**方面注释**集合，最小化方面预测（交叉熵）损失函数。

### 方面融合网络（AFN）

- **与输入无关的加权和**：简单直接、与输入无关，无法对输入进行自适应调整
- **方面存在权重**：根据方面信息是否出现在查询中来调整权重
- **门控网络**：使用MoE的方法，将BERT输出的CLS嵌入输入到门控网络中，得到每个方面的权重，不需要其他额外的计算



## 模型效果

- 本文在电子商务数据（电商语料数据集ECD和电商相关性数据集ERD）上进行预训练和微调，查询和文档都包含category、brand和color三个方面的信息。使用的模型有不含方面学习的**MADR**和包含方面学习的**MADRAL**，两个模型的方面融合网络都使用**方面存在权重**的方法。
- 在检索任务、排序任务和方面预测任务中，MADRM的性能相较于BiBERT、MpBERT、MtBERT和DSSM等基线方法有显著的提升。
- **消融实验**中MADRAL相较于MADR性能的提升证明了**方面学习**能够为检索模型和信息检索任务带来正面的影响。
- 相较于其他黑盒密集检索模型，MADRM因为**显式**表示了不同方面的信息，因此有更好的**可解释性**。
- 由于将多方面嵌入作为最终的查询和文档嵌入，因此相较于之前的工作，MADRM没有多余的索引和查询**开销**。MADRM将BiBERT中最后的Transformer层替换为AEN层和AFN层，模型的**参数量和复杂度**有所下降。



## 模型优势

- 因为引入了**方面嵌入**，MADRM能够更有效捕捉相关性预测中不同方面的信息，提高检索质量。
- 因为引入了**方面学习**，MADRM能够学习领域的知识。
- 因为**显式**表示了查询和文档不同方面的信息，因此MADRM增强了模型的**可解释性**。
- 由于将多方面嵌入作为最终的查询和文档嵌入，因此相较于之前的工作，MADRM没有多余的索引和查询**开销**。
- MADRM将BiBERT中最后的Transformer层替换为AEN层和AFN层，模型的**参数量和复杂度**有所下降。



## 模型和实验缺陷

- 在一些场景中，**方面注释**可能是不可获得或**不可用**的，此时会对方面预测任务造成影响，只能隐式学习方面嵌入，最终对模型效果造成影响。
- 实验中没有使用公共数据集，也没有部署到线上场景，无法得知落地效果。



## 未来研究思路

- 设计更好的**相似函数**和**最近邻搜索算法**，使学习得到的**方面嵌入**能够得到更加充分的利用。
- 增加方面的**规模**，使模型学习更充分的领域知识。
- 使用**MoE**等方法稀疏地激活特定的方面，提高模型在实际应用时的效率。
- 可以配合**生成模型**，对一个文档生成不同的查询，丰富查询类型，产生更多的方面信息，从而使模型获得更好的效果。